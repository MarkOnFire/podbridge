# Claude Progress Tracker
# Last Updated: 2026-01-21

## V3.5 Orchestration Status

**Orchestrator:** The Conductor
**Mode:** Multi-Sprint Planning
**Status:** Ready for Sprint 11.1 Execution

---

## Current Sprint: 11.1 - Remote Ingest Server Watcher (REVISED)

### Sprint Goal
Monitor the PBS Wisconsin media ingest server on a configurable schedule for SRT
transcript files and JPG screen grabs that match QC-passed content in Airtable SST.
Display matches in a "Ready to Queue" screen for one-click processing.

### Key Design Decisions (2026-01-21 Revision)

1. **Trigger**: Scheduled scan at configurable interval (default: daily at midnight)
   - Not continuous polling
   - Manual "Check Now" button available
   - Settings configurable via web UI

2. **Smart Scanning**: Only look for files matching QC-passed Media IDs
   - Query SST for QC-passed records without existing jobs
   - Then check ingest server for matching files
   - Much more efficient than tracking all files

3. **Server Access**: No auth needed (open for system-to-system transfers)
   - URL: https://mmingest.pbswi.wisc.edu/
   - Structure: Project directories + "misc" folder
   - Ignore: "promos" folder

4. **File Naming**: Media ID always at start of filename

5. **File Handling**:
   - SRT files: Copy to local transcripts/ folder (server is trimmed regularly)
   - JPG files: Download temporarily for Airtable upload
   - Deletions: Ignore

6. **Screengrab Timing**: May arrive later than transcripts, handled separately

### Feature Specification
See: docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)

### Sprint Status: NOT STARTED

---

## Simplified Task Breakdown (16 tasks, down from 21)

### Phase 1: Foundation (4 tasks) - No dependencies

| ID | Task | Agent | Status |
|----|------|-------|--------|
| 11.1.1 | Database migration: ingest tables | the-drone | pending |
| 11.1.2 | Pydantic models for ingest types | the-drone | pending |
| 11.1.3 | Configuration schema and defaults | the-drone | pending |
| 11.1.4 | APScheduler integration | orchestrator | pending |

### Phase 2: Core Scanner (3 tasks)

| ID | Task | Agent | Status | Depends On |
|----|------|-------|--------|------------|
| 11.1.5 | IngestScanner: SST query for QC-passed | orchestrator | pending | 11.1.2 |
| 11.1.6 | IngestScanner: Directory parser & matching | orchestrator | pending | 11.1.3, 11.1.5 |
| 11.1.7 | IngestScanner: File download | the-drone | pending | 11.1.6 |

### Phase 3: API Layer (4 tasks)

| ID | Task | Agent | Status | Depends On |
|----|------|-------|--------|------------|
| 11.1.8 | Ingest router: Read endpoints | the-drone | pending | 11.1.1, 11.1.2 |
| 11.1.9 | Ingest router: Action endpoints | orchestrator | pending | 11.1.6, 11.1.7, 11.1.8 |
| 11.1.10 | Config update endpoint for Settings | the-drone | pending | 11.1.4, 11.1.8 |
| 11.1.11 | ScreengrabAttacher service | orchestrator | pending | 11.1.1, 11.1.7 |

### Phase 4: Frontend (3 tasks)

| ID | Task | Agent | Status | Depends On |
|----|------|-------|--------|------------|
| 11.1.12 | IngestPanel React component | the-drone | pending | 11.1.8, 11.1.9 |
| 11.1.13 | ScreengrabPanel React component | the-drone | pending | 11.1.8, 11.1.9, 11.1.11 |
| 11.1.14 | Settings page ingest section | the-drone | pending | 11.1.10 |

### Phase 5: Testing (2 tasks)

| ID | Task | Agent | Status | Depends On |
|----|------|-------|--------|------------|
| 11.1.15 | Unit tests for ingest scanner | orchestrator | pending | 11.1.6 |
| 11.1.16 | Integration tests | orchestrator | pending | 11.1.9, 11.1.11 |

---

## Agent Assignment Summary

| Agent | Tasks | Count |
|-------|-------|-------|
| the-drone | 11.1.1-3, 11.1.7-8, 11.1.10, 11.1.12-14 | 9 tasks |
| orchestrator | 11.1.4-6, 11.1.9, 11.1.11, 11.1.15-16 | 7 tasks |

---

## Parallelization Strategy

### Wave 1 (Start immediately - no dependencies)
- 11.1.1: Database migration (the-drone)
- 11.1.2: Pydantic models (the-drone)
- 11.1.3: Configuration (the-drone)

### Wave 2 (After Wave 1)
- 11.1.4: APScheduler (orchestrator) - needs 11.1.3
- 11.1.5: SST query (orchestrator) - needs 11.1.2
- 11.1.8: Read endpoints (the-drone) - needs 11.1.1, 11.1.2

### Wave 3 (After Wave 2)
- 11.1.6: Directory parser (orchestrator) - needs 11.1.3, 11.1.5
- 11.1.10: Config update endpoint (the-drone) - needs 11.1.4, 11.1.8

### Wave 4 (After Wave 3)
- 11.1.7: File download (the-drone) - needs 11.1.6
- 11.1.11: ScreengrabAttacher (orchestrator) - needs 11.1.1, 11.1.7

### Wave 5 (After Wave 4)
- 11.1.9: Action endpoints (orchestrator) - needs 11.1.6, 11.1.7, 11.1.8
- 11.1.15: Unit tests (orchestrator) - needs 11.1.6

### Wave 6 (After Wave 5)
- 11.1.12: IngestPanel (the-drone) - needs 11.1.8, 11.1.9
- 11.1.13: ScreengrabPanel (the-drone) - needs 11.1.8, 11.1.9, 11.1.11
- 11.1.14: Settings section (the-drone) - needs 11.1.10
- 11.1.16: Integration tests (orchestrator) - needs 11.1.9, 11.1.11

---

## Safety Constraints (CRITICAL)

### Airtable Write Policy Exception
This sprint includes a CONTROLLED EXCEPTION to the read-only Airtable policy:

1. **Scope**: ONLY the `Screen Grab` attachment field (fldCCWjcowpE2wJhc)
2. **Operation**: ADDITIVE ONLY - appends new attachments, NEVER removes existing
3. **Audit**: All operations logged to screengrab_attachments table
4. **Idempotent**: Re-running won't duplicate (filename-based duplicate detection)

**Testing requirement**: Tests MUST verify existing attachments are preserved.

---

## Open Questions (RESOLVED 2026-01-21)

| Question | Answer |
|----------|--------|
| Authentication | None needed - open for system-to-system transfers |
| Directory Structure | Project directories + "misc" folder. Ignore "promos" |
| File Naming | Media ID always at start of filename |
| Cleanup Strategy | Ignore deletions. Copy SRTs locally for safekeeping |
| Trigger | Scheduled scan (default daily at midnight), configurable via Settings |
| QC Field | `QC` field in SST indicates pass status |

---

## V3.5 Sprint Roadmap

### Wave 1 (Parallel - Start Now)
- **Sprint 11.1**: Remote Ingest Watcher (16 tasks) ‚Üê CURRENT
- Sprint 12.1: Embedded Chat Prototype (8 tasks)
- Sprint 13.1: Langfuse Integration (7 tasks)
- Sprint 13.2 + 13.3: UX Cleanup + Tests (10 tasks)

### Wave 2-6 (Future)
- Chat completion sprints (12.2-12.4)
- Data visualization sprints (13.4-13.6)
- Content Calendar, Large Transcript Optimization, Plugin System

---

## Session Notes

### 2026-01-21 (Design Revision)
- REVISED Sprint 11.1 based on user feedback
- Changed from continuous polling to scheduled scan (default: daily midnight)
- Changed from "track all files" to "smart scan" (only QC-passed content)
- Answered all open questions about server access, file naming, etc.
- Reduced task count from 21 to 16
- Updated feature spec, feature_list.json, and this file

### 2026-01-12 (Original)
- Created Sprint 11.1 task breakdown from FEATURE_REMOTE_INGEST_WATCHER.md
- Added screengrab auto-attachment functionality (tasks 11.1.13-11.1.21)
