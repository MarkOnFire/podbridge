[
  {
    "_metadata": true,
    "description": "Active feature tasks for Editorial Assistant v3.5+",
    "archive_reference": "planning/archive/feature_list_v3.0_completed.json",
    "last_updated": "2026-01-21"
  },
  {
    "id": "backlog.1",
    "name": "Assess project rename to cardigan-editorial-assistant",
    "sprint": "backlog",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "low",
    "description": "Audit what needs to change to rename project from 'ai-editorial-assistant-v3' to 'cardigan-editorial-assistant'. Less clunky, more distinctive branding. Assessment should identify: git repo rename, package.json changes, Python package names, hardcoded references in code/docs, MCP server registration name, deployment configs, any external integrations referencing the old name.",
    "files": [
      "package.json",
      "web/package.json",
      "mcp_server/server.py",
      "docs/",
      "CLAUDE.md"
    ],
    "exit_criteria": [
      "Complete inventory of files/configs requiring changes",
      "Risk assessment for breaking changes",
      "Recommended migration steps documented",
      "Decision on whether to do in-place rename or fresh repo"
    ],
    "source": "User request 2026-01-12"
  },
  {
    "id": "backlog.2",
    "name": "Content Calendar bulk scheduling interface",
    "sprint": "backlog",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "medium",
    "description": "Design and implement interface for bulk Content Calendar task creation. User workflow: paste list of videos with target days (e.g., 'Midshow 1211 - Cia Siab Inc. - Thursday') → system looks up Media IDs, determines required platforms, checks editing status → creates Content Calendar entries in 'All Tasks' table linked to SST records with publish date/time and due date (2 weeks prior). Reference existing automation: /Users/mriechers/Developer/the-lodge/workflow-automation/airtable-pbswi-automations/scripts/content-calendar-automation.js. SAFETY ARCHITECTURE: Controlled Airtable write access with strict guardrails - (1) scope-limited to Content Calendar/All Tasks table ONLY, (2) append-only operations (CREATE, never UPDATE/DELETE), (3) API-level or code-level enforcement of these constraints, (4) explicit user confirmation before any write.",
    "files": [
      "web/src/pages/Schedule.tsx",
      "api/routers/schedule.py",
      "api/services/airtable.py"
    ],
    "exit_criteria": [
      "Research: Document All Tasks table schema and required fields",
      "Research: Map platform determination logic from SST fields",
      "Research: Understand content-calendar-automation.js patterns",
      "Design: UX mockup for bulk input → preview → confirm flow",
      "Design: Decide on Airtable write policy (agent writes vs human confirms)",
      "Implementation: Working bulk scheduling with editing status visibility"
    ],
    "source": "User request 2026-01-12",
    "research_refs": [
      "/Users/mriechers/Developer/the-lodge/workflow-automation/airtable-pbswi-automations/scripts/content-calendar-automation.js",
      "docs/AIRTABLE_CHEATSHEET.md"
    ]
  },
  {
    "id": "backlog.3",
    "name": "Cloudflare Tunnel for remote access",
    "sprint": "backlog",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "medium",
    "description": "Configure Cloudflare Tunnel to expose API (port 8000) and web dashboard (port 3000) for secure remote access. Use Cloudflare Access for email-based authentication without requiring application-level auth changes. Enables remote MCP access from Claude Desktop on different machines. Bridge item between V3.5 feature work and V4.0 deployment - allows remote testing without full production hardening.",
    "files": [
      "scripts/start.sh",
      "docs/REMOTE_ACCESS.md"
    ],
    "exit_criteria": [
      "cloudflared installed and tunnel created",
      "API and web dashboard accessible via tunnel URL",
      "Cloudflare Access configured with email allowlist",
      "Documentation for setup and usage",
      "Optional: MCP server exposed for remote Claude Desktop"
    ],
    "source": "User request 2026-01-14",
    "notes": "Tactical infrastructure task, not a product feature. Can be done independently of sprint work. See planning/DESIGN_4.0.md Part 6 for detailed setup instructions."
  },
  {
    "id": "11.1.1",
    "name": "Database migration: ingest tables",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "critical",
    "description": "Create Alembic migration for ingest feature tables: available_files (tracks discovered files), screengrab_attachments (audit log), and ingest_config (runtime settings). Update existing migration 006 or create new one. Include all columns from revised spec: file_type, status, airtable_record_id, attached_at. Add proper indexes.",
    "files": [
      "alembic/versions/006_add_ingest_watcher_tables.py"
    ],
    "exit_criteria": [
      "available_files table with all columns per spec",
      "screengrab_attachments audit table created",
      "ingest_config key-value table for runtime settings",
      "Indexes on status, media_id, file_type, first_seen_at",
      "Migration runs without error (up and down)"
    ],
    "dependencies": [],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.2",
    "name": "Pydantic models for ingest types",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "critical",
    "description": "Create Pydantic models for ingest-related data types: RemoteFile (file discovered on server), AvailableFile (database record), ScanResult (scan operation result), IngestConfig (runtime settings). Include SST record preview fields for UI display.",
    "files": [
      "api/models/ingest.py"
    ],
    "exit_criteria": [
      "RemoteFile model with url, filename, size, modified_at, file_type",
      "AvailableFile model matching database schema with SST record preview",
      "ScanResult with qc_passed_checked, new_transcripts_found, new_screengrabs_found",
      "IngestConfig with enabled, scan_interval_hours, scan_time, last_scan_at"
    ],
    "dependencies": [],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.3",
    "name": "Configuration schema and defaults",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "critical",
    "description": "Add ingest_server configuration section to config/llm-config.json with defaults: enabled=true, base_url, directories=['/exports/', '/misc/'], ignore_directories=['/promos/'], scan_interval_hours=24, scan_time='00:00'. Load and validate on startup. Support runtime override from ingest_config database table.",
    "files": [
      "config/llm-config.json",
      "api/services/config.py"
    ],
    "exit_criteria": [
      "ingest_server section in llm-config.json with all defaults",
      "Config loaded and validated on app startup",
      "Runtime settings from database override file defaults",
      "Graceful handling when config section missing"
    ],
    "dependencies": ["11.1.1"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.4",
    "name": "APScheduler integration for scheduled scans",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "critical",
    "description": "Integrate APScheduler for configurable scheduled scans. Default: daily at midnight. Load schedule from ingest_config table. Support dynamic schedule updates when user changes settings via API. Graceful startup/shutdown with FastAPI lifespan events.",
    "files": [
      "api/main.py",
      "api/services/scheduler.py",
      "requirements.txt"
    ],
    "exit_criteria": [
      "APScheduler installed and configured",
      "Scheduled job runs at configured time (default midnight)",
      "Schedule updates when config changes via PUT /api/ingest/config",
      "Clean shutdown on app termination",
      "Can be disabled via config"
    ],
    "dependencies": ["11.1.3"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.5",
    "name": "IngestScanner: SST query for QC-passed Media IDs",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "critical",
    "description": "Implement get_qc_passed_media_ids() method that queries Airtable SST for records where QC field indicates passed, and filters out Media IDs that already have jobs in the system. This is the 'smart scan' approach - only look for files we care about.",
    "files": [
      "api/services/ingest_scanner.py",
      "api/services/airtable.py"
    ],
    "exit_criteria": [
      "Query SST for QC-passed records (determine exact field value)",
      "Filter out Media IDs with existing jobs in database",
      "Return list of Media IDs to search for on ingest server",
      "Handle Airtable API errors gracefully",
      "Configurable batch size for large result sets"
    ],
    "dependencies": ["11.1.2"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.6",
    "name": "IngestScanner: Directory parser and file matching",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "critical",
    "description": "Implement parse_directory_listing() for Apache/nginx autoindex HTML and check_ingest_server() to find files matching a Media ID. Scan configured directories, skip ignore_directories (promos). Extract file type from extension. Media ID is always at start of filename.",
    "files": [
      "api/services/ingest_scanner.py"
    ],
    "exit_criteria": [
      "parse_directory_listing() extracts files from Apache/nginx HTML",
      "check_ingest_server(media_id) returns matching files",
      "File type determined by extension (.srt=transcript, .jpg=screengrab)",
      "Configured directories scanned, ignore_directories skipped",
      "Graceful handling of network errors and malformed HTML"
    ],
    "dependencies": ["11.1.3", "11.1.5"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.7",
    "name": "IngestScanner: File download to local transcripts/",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "high",
    "description": "Implement download_file() method that downloads a file from remote URL to local transcripts/ folder. SRT files are copied for safekeeping (server is regularly trimmed). JPG files downloaded temporarily for Airtable upload. URL validation to only allow configured base URL.",
    "files": [
      "api/services/ingest_scanner.py"
    ],
    "exit_criteria": [
      "download_file() fetches remote file to transcripts/",
      "URL validation prevents downloads from non-allowed domains",
      "File size limit enforced (configurable, default 100MB)",
      "Returns Path to downloaded file",
      "Proper cleanup on failure"
    ],
    "dependencies": ["11.1.6"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.8",
    "name": "Ingest router: Read endpoints",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "critical",
    "description": "Implement read-only endpoints: GET /api/ingest/available (list new files with SST preview), GET /api/ingest/config (scanner settings), GET /api/ingest/screengrabs (screengrab-specific view). Include SST record info (title, project) in responses for UI display.",
    "files": [
      "api/routers/ingest.py",
      "api/main.py"
    ],
    "exit_criteria": [
      "GET /available returns files with status filter and SST preview",
      "GET /config returns current scanner settings",
      "GET /screengrabs returns screengrab files with attachment status",
      "Router registered in main.py",
      "Proper error handling and validation"
    ],
    "dependencies": ["11.1.1", "11.1.2"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.9",
    "name": "Ingest router: Action endpoints",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "critical",
    "description": "Implement action endpoints: POST /queue/{file_id} (download and create job), POST /queue/bulk, POST /ignore/{file_id}, POST /scan (manual trigger), POST /screengrabs/{file_id}/attach, POST /screengrabs/attach-all. Queue endpoints integrate with existing job creation and SST auto-linking.",
    "files": [
      "api/routers/ingest.py"
    ],
    "exit_criteria": [
      "POST /queue/{file_id} downloads file and creates job with SST linking",
      "POST /queue/bulk handles multiple files",
      "POST /ignore updates file status",
      "POST /scan triggers immediate scan and returns results",
      "Screengrab attach endpoints use ScreengrabAttacher service",
      "Proper error responses for not found, already queued, etc."
    ],
    "dependencies": ["11.1.6", "11.1.7", "11.1.8"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.10",
    "name": "Config update endpoint for Settings page",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "high",
    "description": "Implement PUT /api/ingest/config to update scanner settings from web UI. Validates input, updates ingest_config database table, and triggers scheduler update if interval/time changed. Settings: enabled, scan_interval_hours, scan_time.",
    "files": [
      "api/routers/ingest.py"
    ],
    "exit_criteria": [
      "PUT /config accepts enabled, scan_interval_hours, scan_time",
      "Validates input (hours 1-168, time format HH:MM)",
      "Updates ingest_config table",
      "Triggers scheduler reschedule on success",
      "Returns updated config in response"
    ],
    "dependencies": ["11.1.4", "11.1.8"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.11",
    "name": "ScreengrabAttacher service",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "high",
    "description": "Complete ScreengrabAttacher service implementation. SAFETY CRITICAL: Additive-only writes to Screen Grab field. Methods: attach_screengrab(file_id), attach_all_pending(). Fetches existing attachments before update, appends new one, logs to audit table. Duplicate detection by filename.",
    "files": [
      "api/services/screengrab_attacher.py"
    ],
    "exit_criteria": [
      "attach_screengrab() appends to existing attachments (NEVER replaces)",
      "Fetches current attachments before update to preserve them",
      "Detects duplicate filenames and skips",
      "Logs all operations to screengrab_attachments audit table",
      "Sets status='no_match' when Media ID not found in SST",
      "attach_all_pending() processes all new screengrabs with rate limiting"
    ],
    "dependencies": ["11.1.1", "11.1.7"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.12",
    "name": "IngestPanel React component",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "high",
    "description": "Create IngestPanel component showing 'Ready to Queue' items. Displays files with Media ID, title (from SST), project. Actions: Queue individual, Queue selected, Ignore. Shows last scan time and next scheduled scan. 'Check Now' button for manual scan.",
    "files": [
      "web/src/components/IngestPanel.tsx"
    ],
    "exit_criteria": [
      "Displays list of new files with SST metadata",
      "Queue button creates job for individual file",
      "Bulk select and Queue Selected functionality",
      "Ignore button hides file from list",
      "Check Now button triggers manual scan",
      "Shows last scan time and next scheduled scan",
      "Loading and empty states handled"
    ],
    "dependencies": ["11.1.8", "11.1.9"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.13",
    "name": "ScreengrabPanel React component",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "high",
    "description": "Create ScreengrabPanel component showing screengrab attachment status. Displays pending screengrabs with SST match info and existing attachment count. Actions: Attach individual, Attach All. Shows no-match items separately with explanation.",
    "files": [
      "web/src/components/ScreengrabPanel.tsx"
    ],
    "exit_criteria": [
      "Lists pending screengrabs with Media ID and SST match info",
      "Shows existing screengrab count on SST record",
      "Attach button with confirmation",
      "Attach All button with count",
      "No-match items displayed separately",
      "Loading and empty states handled"
    ],
    "dependencies": ["11.1.8", "11.1.9", "11.1.11"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.14",
    "name": "Settings page ingest section",
    "sprint": "11.1",
    "status": "pending",
    "agent": "the-drone",
    "priority": "high",
    "description": "Add Ingest Scanner Settings section to Settings page. Controls: enabled toggle, scan interval (hours), scan time (HH:MM picker). Shows server URL as read-only. Updates config via PUT /api/ingest/config.",
    "files": [
      "web/src/pages/Settings.tsx"
    ],
    "exit_criteria": [
      "Ingest Scanner Settings section in Settings page",
      "Enabled toggle updates config",
      "Scan interval input (1-168 hours)",
      "Scan time picker (HH:MM format)",
      "Server URL displayed read-only",
      "Save button calls PUT /api/ingest/config",
      "Success/error feedback to user"
    ],
    "dependencies": ["11.1.10"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.15",
    "name": "Unit tests for ingest scanner",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "medium",
    "description": "Create unit tests for IngestScanner service. Test HTML parsing for various Apache/nginx formats, Media ID extraction from filenames, file type detection. Mock HTTP responses.",
    "files": [
      "tests/test_ingest_scanner.py"
    ],
    "exit_criteria": [
      "Tests for parse_directory_listing() with Apache HTML samples",
      "Tests for parse_directory_listing() with nginx HTML samples",
      "Tests for Media ID extraction edge cases",
      "Tests for file type detection by extension",
      "Mocking used for HTTP requests",
      "Tests pass in CI"
    ],
    "dependencies": ["11.1.6"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  },
  {
    "id": "11.1.16",
    "name": "Integration tests for ingest API and screengrab attacher",
    "sprint": "11.1",
    "status": "pending",
    "agent": "orchestrator",
    "priority": "medium",
    "description": "Create integration tests for ingest API endpoints and ScreengrabAttacher. CRITICAL: Test that existing Airtable attachments are NEVER removed. Test SST query, API endpoints, queue workflow, screengrab attachment with mocked Airtable.",
    "files": [
      "tests/test_ingest_api.py",
      "tests/test_screengrab_attacher.py"
    ],
    "exit_criteria": [
      "Tests for all ingest API endpoints",
      "Tests for queue workflow (download, create job, SST link)",
      "Tests verify existing Airtable attachments preserved (CRITICAL)",
      "Tests verify duplicate filename detection",
      "Tests verify no_match status when SST not found",
      "Tests verify audit log entries created",
      "Airtable API mocked for all tests"
    ],
    "dependencies": ["11.1.9", "11.1.11"],
    "source": "docs/FEATURE_REMOTE_INGEST_WATCHER.md (Revised 2026-01-21)"
  }
]
